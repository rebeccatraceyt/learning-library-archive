<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../../assets/css/bitesize/removing-files.css" />
    <title>React - Custom Hooks</title>
  </head>
  <body>
    <nav>
      <a href="../../bitesize.html">Bitesize</a>
      <a href="../../checklist.html">Checklists</a>
      <a href="../../flashcards.html">Flash</a>
    </nav>
    <section id="template-body" class="box-shadow">
      <div id="header">
        <div id="header-text">
          <h1 class="text-heading">Git: Removing Large or Sensitive Files</h1>
          <p class="section-padding">
            Git is an excellent version control system. It is not, however, an excellent file storage system. As a result, Github imposes a max file size limit of 100Mb. If you try to push a file that is larger than this, you will get an error. You will need to remove this file from your repository's history before you can push again.
          </p>
          <hr id="header-hr" />
        </div>
      </div>
      <div class="body">
        <div class="section-padding">
          <h3>How do we do that?</h3>
        </div>
        <p class="section-padding">
          There are a few ways we can remove a large file from our repository history, but the method we will need is dependant on when you commited the file to your repository; 
        </p>
        <div class="section-margin arrow-points">
          <img src="https://4060571.fs1.hubspotusercontent-na1.net/hubfs/4060571/library-assets/arrow-right_red.svg" alt="red arrow pointing right">
          <span>Was it the last commit you made?</span>
        </div>
        <div class="section-margin arrow-points">
          <img src="https://4060571.fs1.hubspotusercontent-na1.net/hubfs/4060571/library-assets/arrow-right_red.svg" alt="red arrow pointing right">
          <span>Or was it a few commits ago?</span>
        </div>
        <p class="section-padding">
          Let’s take a look at what we can do in each instance!
        </p>
        <div class="section-padding">
          <span class="alt-text red">Remove from most recent commit</span>
        </div>
        
        <p class="section-padding">
          If the file was added in your most recent unpushed commit, you can follow these steps to remove it: 
        </p>
        <div class="section-padding circle-points">
          <span class="circle-light">1</span>
          <span>First, we need to remove the file, by entering the command:
          <br />
          <em>This will stage our file to be removed</em>
          </span>
        </div>
        <div class="section-padding">
          <div class="code-block">
            <div class="code-text code-container box-shadow">
              <span class="green">user@ci-os</span><span class="blue"> /home/user</span> (main) $ git rm --cached NAME_OF_FILE_TO_REMOVE
              </span>
            </div>
          </div>
          </div>
        
        <div class="section-padding circle-points">
          <span class="circle-light">2</span>
          <span>Then, we'll need to commit this change with:
            <br />
          <em>This will amend the commit, including the removal of the file</em>
          </span>
        </div>
        <div class="section-padding">
          <div class="code-block">
            <div class="code-text code-container box-shadow">
              <span class="green">user@ci-os</span><span class="blue"> /home/user</span> (main) $ git commit --amend -CHEAD
            </span>
            </div>
          </div>
        </div>
        <div class="section-padding circle-points">
          <span class="circle-light">3</span>
          <span>Lastly, we’ll push our amended commit with:
          </span>
        </div>
        <div class="section-padding">
          <div class="code-block">
            <div class="code-text code-container box-shadow">
              <span class="green">user@ci-os</span><span class="blue"> /home/user</span> (main) $ git push origin main
            </span>
            </div>
          </div>
        </div>
        <div class="section-margin idea-section">
          <div class="idea-img">
            <img src="https://4060571.fs1.hubspotusercontent-na1.net/hubfs/4060571/library-assets/lightbulb_red_upright.svg" alt="Red lightbulb upright">
          </div>
          <div class="idea-text">
              <span>Click <a class="link-text" href="https://docs.github.com/en/repositories/working-with-files/managing-large-files/about-large-files-on-github#removing-files-from-a-repositorys-history">here</a> to head over to the GitHub docs for more information! </span> 
          </div>
        </div>
        <div class="section-padding">
          <span class="alt-text red">Remove from a previous commit</span>
        </div>
        <p class="section-padding">
          The first method may not always be possible - you may have made subsequent commits before trying to push. In that case, the simplest way to remove the file is with git's filter-branch command: 
        </p>
        <div class="section-padding">
          <div class="code-block">
            <div class="code-text code-container box-shadow">
              <span class="green">user@ci-os</span><span class="blue"> /home/user</span> (main) $ git filter-branch --index-filter 'git rm --cached --ignore-unmatch NAME_OF_FILE_TO_REMOVE' HEAD
            </span>
            </div>
          </div>
        </div>
        <p class="section-padding">
          Once the command finishes running (it may take a few minutes), you will be able to push. 
        </p>
        <p class="section-padding">
          Remember to either add the large file to your <b class="code-text">.gitignore</b> or delete it to prevent it from being committed again. 
        </p>
        <div class="section-margin idea-section">
          <div class="idea-img">
            <img src="https://4060571.fs1.hubspotusercontent-na1.net/hubfs/4060571/library-assets/lightbulb_yellow_left.svg" alt="Yellow lightbulb icon tilted left">
          </div>
          <div class="idea-text">
              <span>The above command can also be used to remove sensitive files from your repository, like an env.py.
              </span> 
          </div>
        </div>
      </div>
      <div id="footer-icon">
        <img
          src="https://4060571.fs1.hubspotusercontent-na1.net/hubfs/4060571/library-assets/library-logo-dark.png"
          alt="Code Institute logo"
        />
      </div>
    </section>
  </body>
</html>
